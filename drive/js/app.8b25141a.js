(function(t){function e(e){for(var n,r,s=e[0],l=e[1],c=e[2],u=0,v=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&v.push(o[r][0]),o[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);d&&d(e);while(v.length)v.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,s=1;s<a.length;s++){var l=a[s];0!==o[l]&&(n=!1)}n&&(i.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},o={app:0},i=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"024c":function(t,e,a){"use strict";var n=a("7c52"),o=a.n(n);o.a},2926:function(t,e,a){"use strict";var n=a("d5a2"),o=a.n(n);o.a},3323:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e623"),a("e379"),a("5dc8"),a("37e1");var n=a("2b0e"),o=(a("d3b7"),a("bc3a")),i=a.n(o),r={},s=i.a.create(r);s.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),s.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)})),Plugin.install=function(t){t.axios=s,window.axios=s,Object.defineProperties(t.prototype,{axios:{get:function(){return s}},$axios:{get:function(){return s}}})},n["default"].use(Plugin);Plugin;var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("AppBar"),a("Drawer",{ref:"drawer"}),a("v-content",[a("router-view"),a("Snackbar")],1),a("Footer",{ref:"footer"})],1)},c=[],d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-app-bar",{staticClass:"d-flex d-lg-none"},[a("v-app-bar-nav-icon",{on:{click:t.changeDrawer}}),a("v-toolbar-title",[t._v("")]),a("v-spacer")],1)],1)},u=[],v={methods:{changeDrawer:function(){this.$store.commit("changeDrawerState")}}},m=v,f=a("2877"),p=a("6544"),h=a.n(p),g=a("40dc"),b=a("5bc1"),w=a("2fa4"),x=a("2a7f"),k=Object(f["a"])(m,d,u,!1,null,null,null),_=k.exports;h()(k,{VAppBar:g["a"],VAppBarNavIcon:b["a"],VSpacer:w["a"],VToolbarTitle:x["a"]});var $=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-navigation-drawer",{attrs:{app:""},model:{value:t.isDrawerOpen,callback:function(e){t.isDrawerOpen=e},expression:"isDrawerOpen"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"title"},[t._v(" "+t._s(this.$store.state.settings.appName)+" ")])],1)],1),a("v-divider"),a("v-list",{attrs:{dense:"",nav:""}},[a("v-list-group",{attrs:{"prepend-icon":"mdi-microsoft-onedrive",value:"true"},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",[t._v("驱动器")])],1)]},proxy:!0}])},t._l(t.sites,(function(e){return a("v-list-item",{key:e.name,attrs:{link:"",to:"/"+e.name}},[a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.nickName))])],1)],1)})),1),t._l(t.actions,(function(e,n){return a("v-list-item",{key:n,attrs:{link:"",to:e.to}},[a("v-list-item-icon",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.title))])],1)],1)}))],2)],1)},D=[],V={data:function(){return{sites:[],actions:[]}},mounted:function(){var t=this;i.a.get(this.$store.state.settings.baseUrl+"/api/sites").then((function(e){t.sites=e.data}))},computed:{isDrawerOpen:{get:function(){return this.$store.state.isDrawerOpen},set:function(t){this.$store.commit("changeDrawerState",t)}}},methods:{updateActions:function(t){this.actions.push(t)}}},y=V,C=a("ce7e"),N=a("132d"),B=a("8860"),S=a("56b0"),U=a("da13"),P=a("5d23"),T=a("34c3"),O=a("f774"),I=Object(f["a"])(y,$,D,!1,null,null,null),j=I.exports;h()(I,{VDivider:C["a"],VIcon:N["a"],VList:B["a"],VListGroup:S["a"],VListItem:U["a"],VListItemContent:P["a"],VListItemIcon:T["a"],VListItemTitle:P["c"],VNavigationDrawer:O["a"]});var E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-snackbar",{attrs:{right:"",top:""},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(this.$store.state.snackbar.message)+" "),a("v-btn",{attrs:{color:"pink",text:""},on:{click:function(e){t.snackbar=!1}}},[t._v(" 关闭 ")])],1)},L=[],A={data:function(){return{text:this.$store.state.snackbar.message}},computed:{snackbar:{set:function(t){this.$store.commit("changeSnackBarStatus",t)},get:function(){return this.$store.state.snackbar.isOpen}}}},F=A,z=a("8336"),M=a("2db4"),R=Object(f["a"])(F,E,L,!1,null,null,null),q=R.exports;h()(R,{VBtn:z["a"],VSnackbar:M["a"]});var H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-footer",{staticClass:"font-weight-medium mt-2"},[a("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[a("div",{staticClass:"footer",attrs:{id:"footer"}})])],1)},Y=[],G=a("a78e"),J=a.n(G),K=(a("99af"),a("b0c0"),a("2f62"));n["default"].use(K["a"]);var X=new K["a"].Store({state:{custom:{appName:"YukiDrive"},isDrawerOpen:void 0,snackbar:{message:void 0,isOpen:!1},settings:{appName:void 0,webName:void 0,navImg:void 0,defaultDrive:void 0,footer:void 0,baseUrl:"".concat(window.location.protocol,"//").concat(window.location.host)},show:{name:void 0,url:void 0,icon:void 0,downloadUrl:void 0},token:void 0==J.a.get("token")?"":J.a.get("token")},mutations:{changeDrawerState:function(t,e){t.isDrawerOpen=e||!t.isDrawerOpen},openSnackBar:function(t,e){t.snackbar.message=e,t.snackbar.isOpen=!0},changeSnackBarStatus:function(t,e){t.snackbar.isOpen=e},changeSettings:function(t,e){t.settings.appName=e.appName,t.settings.webName=e.webName,t.settings.navImg=e.navImg,t.settings.defaultDrive=e.defaultDrive,t.settings.footer=e.footer},showItem:function(t,e){t.show.name=e.name,t.show.url=e.url,t.show.icon=e.icon,t.show.downloadUrl=e.downloadUrl}},actions:{},modules:{}}),Z=a("d4cd"),Q=a.n(Z);function W(t){if(0===t)return"0 B";var e=1024,a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,n)).toPrecision(3)+" "+a[n]}var tt=function(t){X.commit("openSnackBar","出现错误："+t.response.data.message)};function et(t,e,a){i()({url:t,method:"post",data:e,headers:{Authorization:"Bearer ".concat(J.a.get("token"))}}).then(a).catch(tt)}function at(t,e,a){i()({url:t,method:"get",data:e,headers:{Authorization:J.a.get("token")?"Bearer ".concat(J.a.get("token")):""}}).then(a).catch(tt)}function nt(t,e,a){i()({url:t,method:"delete",params:e,headers:{Authorization:"Bearer ".concat(J.a.get("token"))}}).then(a).catch(tt)}function ot(t){var e=new Q.a;return e.render(t)}var it={data:function(){return{footer:this.$store.state.settings.footer}},watch:{footer:function(){this.updateFooter()}},methods:{updateFooter:function(){document.getElementById("footer").innerHTML=ot(this.$store.state.settings.footer)}}},rt=it,st=(a("e8d0"),a("62ad")),lt=a("553a"),ct=Object(f["a"])(rt,H,Y,!1,null,null,null),dt=ct.exports;h()(ct,{VCol:st["a"],VFooter:lt["a"]});var ut={name:"App",components:{AppBar:_,Drawer:j,Snackbar:q,Footer:dt},data:function(){return{}},mounted:function(){var t=this;i.a.get(this.$store.state.settings.baseUrl+"/api/info").then((function(e){t.$store.commit("changeSettings",{appName:e.data.appName,webName:e.data.webName,navImg:e.data.navImg,defaultDrive:e.data.defaultDrive,footer:e.data.footer}),document.title=e.data.webName,t.$refs.footer.updateFooter(),"/"==t.$route.path&&t.$router.push(e.data.defaultDrive),t.$refs.footer.updateFooter(),(e.data.allowUpload||""!=t.$store.state.token)}))}},vt=ut,mt=a("7496"),ft=a("a75b"),pt=Object(f["a"])(vt,l,c,!1,null,null,null),ht=pt.exports;h()(pt,{VApp:mt["a"],VContent:ft["a"]});var gt=a("8c4f"),bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"12","offset-md":"2",md:"8",align:"start",justify:"center"}},[a("v-card",[t.isInProgressing?a("v-progress-linear",{attrs:{indeterminate:""}}):t._e(),0!=t.router.length?a("div",[a("v-breadcrumbs",{staticClass:"pl-4 pb-0 pt-4",attrs:{items:t.router}}),a("v-divider",{staticClass:"ml-4 mr-4 mt-1"})],1):t._e(),a("v-list",{attrs:{"two-line":""}},[0!=t.folders.length?a("div",[a("v-subheader",[t._v("文件夹")]),a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.folders,(function(e,n){return a("v-list-item",{key:n,attrs:{to:e.name,append:""}},[a("v-list-item-avatar",[a("v-icon",{attrs:{large:""}},[t._v("mdi-folder")])],1),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.name)}}),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.createdTime+"  "+e.size)}})],1)],1)})),1)],1):t._e(),0!=t.files.length?a("div",[a("v-subheader",[t._v("文件")]),a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.files,(function(e,n){return a("v-list-item",{key:n},[a("v-list-item-avatar",[a("v-icon",{attrs:{large:""},on:{click:function(a){return t.openDetial(e)}}},[t._v(t._s(e.icon))])],1),a("v-list-item-content",{on:{click:function(a){return t.openDetial(e)}}},[a("v-list-item-title",{domProps:{textContent:t._s(e.name)}}),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.createdTime+"  "+e.size)}})],1),a("v-list-item-action",[a("v-btn",{staticClass:"copy-url",attrs:{icon:"","data-clipboard-text":e.downloadUrl}},[a("v-icon",[t._v("mdi-content-copy")])],1)],1),a("v-list-item-action",{staticClass:"ml-0"},[a("v-btn",{attrs:{icon:"",href:e.downloadUrl},on:{click:function(a){return t.downloadFile(e.downloadUrl)}}},[a("v-icon",[t._v("mdi-download")])],1)],1)],1)})),1)],1):t._e()])],1),this.$route.params.folderPath?t._e():a("v-card",{staticClass:"mt-4"},[a("div",{staticClass:"pa-4 readme",attrs:{id:"readme"}})])],1)],1)],1)},wt=[],xt=(a("4160"),a("c975"),a("baa5"),a("a434"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),a("5319"),a("1276"),a("159b"),a("b311")),kt=a.n(xt),_t={data:function(){return{files:[],folders:[],router:[],isInProgressing:!1}},mounted:function(){new kt.a(".copy-url"),this.$route.params.folderPath?(this.changeRouter(),this.show(this.$route.params.folderPath)):this.$route.params.siteName&&(this.show(),this.loadReadme())},watch:{$route:function(){this.show(this.$route.params.folderPath),this.$route.params.folderPath?this.changeRouter():(this.router.splice(0),this.loadReadme())}},methods:{loadReadme:function(){i.a.get("".concat(this.$store.state.settings.baseUrl,"/api/readme")).then((function(t){document.getElementById("readme").innerHTML=ot(t.data.readme)}))},changeProgressBar:function(){this.isInProgressing=!this.isInProgressing},show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.changeProgressBar(),this.folders.splice(0),this.files.splice(0);var a=function(e){e.data.forEach((function(e){e.createdTime=new Date(e.createdTime).toLocaleString("zh-CN",{year:"numeric",month:"numeric",day:"numeric"}),e.size=W(e.size),null==e.downloadUrl?t.folders.push(e):(e.icon=$t(e.name),e.url=e.downloadUrl,t.$route.params.folderPath?e.downloadUrl="".concat(t.$store.state.settings.baseUrl,"/api/files/").concat(t.$route.params.siteName,"/").concat(t.$route.params.folderPath,"/").concat(e.name):e.downloadUrl="".concat(t.$store.state.settings.baseUrl,"/api/files/").concat(t.$route.params.siteName,"/").concat(e.name),t.files.push(e))})),t.changeProgressBar()};at("".concat(this.$store.state.settings.baseUrl,"/api/sites/").concat(this.$route.params.siteName,"/").concat(e),null,a)},changeRouter:function(){var t=this;this.router.splice(0);var e=this.$route.params.folderPath.split("/");this.router.push({text:"根目录",href:"#/".concat(this.$route.params.siteName),disabled:!1}),e.forEach((function(e){var a=new RegExp("".concat(e,".*")),n=t.$route.params.folderPath.replace(a,e);t.router.push({text:e,href:"#/".concat(t.$route.params.siteName,"/").concat(n),disabled:!1})})),this.router[this.router.length-1].disabled=!0},openDetial:function(t){this.$store.commit("showItem",{name:t.name,url:t.url,icon:t.icon,downloadUrl:t.downloadUrl}),null!=$t(t.name).match("microsoft")&&window.open("https://view.officeapps.live.com/op/view.aspx?src="+t.downloadUrl),this.$router.push("/show")}}};function $t(t){var e=t.lastIndexOf("."),a=t.substr(e+1).toLowerCase(),n=["png","jpg","jpeg","bmp","gif","webp","psd","svg","tiff"],o=["wmv","asf","asx","rm","rmvb","mpg","mpeg","mpe","3gp","mov","mp4","m4v","avi","dat","mkv","flv","vob"],i=["mp3","wav","wma","ape","flac","aac"],r=["zip","rar","7z","gz","bz2","xz","tar","tar.gz","tar.bz2","tar.xz"],s=["doc","docx"];return-1!==n.indexOf(a)?"mdi-image":-1!==o.indexOf(a)?"mdi-movie":-1!==i.indexOf(a)?"mdi-music":-1!==r.indexOf(a)?"mdi-folder-zip":-1!==s.indexOf(a)?"mdi-microsoft-word":"xlsx"==a?"mdi-microsoft-excel":"ppt"==a?"mdi-microsoft-powerpoint":"pdf"==a?"mdi-file-pdf-box":"md"==a?"mdi-text-box-outline":"mdi-file"}var Dt=_t,Vt=(a("024c"),a("2bc5")),yt=a("b0af"),Ct=a("a523"),Nt=a("1800"),Bt=a("8270"),St=a("1baa"),Ut=a("8e36"),Pt=a("0fd9b"),Tt=a("e0c7"),Ot=Object(f["a"])(Dt,bt,wt,!1,null,null,null),It=Ot.exports;h()(Ot,{VBreadcrumbs:Vt["a"],VBtn:z["a"],VCard:yt["a"],VCol:st["a"],VContainer:Ct["a"],VDivider:C["a"],VIcon:N["a"],VList:B["a"],VListItem:U["a"],VListItemAction:Nt["a"],VListItemAvatar:Bt["a"],VListItemContent:P["a"],VListItemGroup:St["a"],VListItemSubtitle:P["b"],VListItemTitle:P["c"],VProgressLinear:Ut["a"],VRow:Pt["a"],VSubheader:Tt["a"]});var jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"12","offset-md":"2",md:"8",align:"start",justify:"center"}},[a("v-card",[a("v-toolbar",{attrs:{dense:"",flat:""}},[a("v-toolbar-title",[t._v("SharePoint 账户")])],1),a("v-card-text",[a("p",[t._v("账户类型："+t._s(t.settings.officeType))]),a("p",[t._v("当前账户："+t._s(t.settings.officeName))]),a("p",[t._v("当前状态："+t._s(t.settings.accountStatus))])]),a("v-card-actions",[a("v-btn",{attrs:{text:"",href:this.$store.state.settings.baseUrl+"/api/admin/bind/url"}},[t._v("认证")])],1)],1),a("v-card",{staticClass:"mt-4"},[a("v-toolbar",{attrs:{dense:"",flat:""}},[a("v-toolbar-title",[t._v("SharePoint & Onedrive 站点")])],1),a("v-container",[a("v-row",t._l(t.drives,(function(e,n){return a("v-col",{key:n,attrs:{cols:"12",md:"6",lg:"4"}},[a("v-card",{attrs:{outlined:""}},[a("v-card-title",{staticClass:"d-flex justify-center"},[t._v(" "+t._s(e.nickName)+" ")]),a("v-card-subtitle",{staticClass:"d-flex justify-center"},[t._v(t._s(e.name))]),a("v-card-text",{staticClass:"d-flex justify-center"},[a("v-progress-circular",{attrs:{size:"200",width:"20",color:"primary",value:e.percent}},[t._v(" "+t._s(e.showUsed)+" / "+t._s(e.showTotal)+" ")])],1),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:function(a){return t.openEditDriveDialog(e)}}},[t._v("设置")]),a("v-btn",{attrs:{text:""},on:{click:function(a){return t.unbind(e.nickName)}}},[t._v("解绑")])],1)],1)],1)})),1)],1),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:function(e){t.dialog.newBindDialog=!0}}},[t._v("添加站点")])],1)],1),a("v-card",{staticClass:"mt-4"},[a("v-toolbar",{attrs:{dense:"",flat:""}},[a("v-toolbar-title",[t._v("基本设置")])],1),a("v-form",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",xs:"12"}},[a("v-text-field",{attrs:{label:"网站名称"},model:{value:t.settings.webName,callback:function(e){t.$set(t.settings,"webName",e)},expression:"settings.webName"}}),a("v-text-field",{attrs:{label:"导航栏显示名",hint:"左侧导航栏头部显示的文字"},model:{value:t.settings.appName,callback:function(e){t.$set(t.settings,"appName",e)},expression:"settings.appName"}}),a("v-text-field",{attrs:{label:"设置主驱动器",hint:"填写创建 SharePoint 站点时输入的名称，将被设置为打开网站默认显示的驱动器（输入 onedrive 则为 OneDrive ）"},model:{value:t.settings.defaultDrive,callback:function(e){t.$set(t.settings,"defaultDrive",e)},expression:"settings.defaultDrive"}}),a("v-text-field",{attrs:{label:"页脚",hint:"设置网站页脚，支持 Markdown，建议保留 Power by YukiDrive"},model:{value:t.settings.footer,callback:function(e){t.$set(t.settings,"footer",e)},expression:"settings.footer"}}),a("v-row",[a("v-col",{attrs:{cols:"9"}},[a("v-text-field",{attrs:{label:"CLI 上传密码",hint:"设置密码后配合 YukiDrive 的上传工具使用"},model:{value:t.settings.uploadPassword,callback:function(e){t.$set(t.settings,"uploadPassword",e)},expression:"settings.uploadPassword"}})],1),a("v-col",{attrs:{cols:"3"}},[a("v-switch",{attrs:{label:"是否允许匿名上传"},model:{value:t.settings.allowAnonymouslyUpload,callback:function(e){t.$set(t.settings,"allowAnonymouslyUpload",e)},expression:"settings.allowAnonymouslyUpload"}})],1)],1)],1)],1)],1)],1),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:t.updateSettings}},[t._v("提交")])],1)],1),a("v-card",{staticClass:"mt-4"},[a("v-toolbar",{attrs:{dense:"",flat:""}},[a("v-toolbar-title",[t._v("首页 README")])],1),a("div",{staticClass:"markdown pr-3 pl-3"},[a("Markdown",{model:{value:t.markdownText,callback:function(e){t.markdownText=e},expression:"markdownText"}})],1),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:t.updateReadme}},[t._v("提交")])],1)],1)],1)],1),a("v-dialog",{attrs:{width:"500"},model:{value:t.dialog.newBindDialog,callback:function(e){t.$set(t.dialog,"newBindDialog",e)},expression:"dialog.newBindDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline",attrs:{"primary-title":""}},[t._v(" 新增绑定 ")]),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{label:"站点名称",hint:"创建 SharePoint 站点时输入的名称"},model:{value:t.newBind.siteName,callback:function(e){t.$set(t.newBind,"siteName",e)},expression:"newBind.siteName"}}),a("v-text-field",{attrs:{label:"显示名",hint:"这将用于在左边导航中显示"},model:{value:t.newBind.nickName,callback:function(e){t.$set(t.newBind,"nickName",e)},expression:"newBind.nickName"}})],1)],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(e){t.dialog.newBindDialog=!1}}},[t._v(" 取消 ")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:t.addSite}},[t._v(" 提交 ")])],1)],1)],1),a("v-dialog",{attrs:{width:"500"},model:{value:t.dialog.editDriveDialog,callback:function(e){t.$set(t.dialog,"editDriveDialog",e)},expression:"dialog.editDriveDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline",attrs:{"primary-title":""}},[t._v(" 修改驱动器设置 ")]),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{label:"名称"},model:{value:t.editDriveSettings.nickName,callback:function(e){t.$set(t.editDriveSettings,"nickName",e)},expression:"editDriveSettings.nickName"}}),a("v-text-field",{attrs:{label:"隐藏文件夹",hint:"填写需要隐藏的文件夹，文件夹名称间用 , 隔开，仅管理员可查看被隐藏的文件夹"},model:{value:t.editDriveSettings.hiddenFolders,callback:function(e){t.$set(t.editDriveSettings,"hiddenFolders",e)},expression:"editDriveSettings.hiddenFolders"}})],1)],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(e){t.dialog.editDriveDialog=!1}}},[t._v(" 取消 ")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:t.editDriveName}},[t._v(" 提交 ")])],1)],1)],1)],1)},Et=[],Lt=(a("a15b"),a("8e77")),At={components:{Markdown:Lt["a"]},data:function(){return{drives:[],settings:{officeName:void 0,officeType:void 0,appName:void 0,webName:void 0,defaultDrive:void 0,accountStatus:void 0,footer:void 0,allowAnonymouslyUpload:void 0,uploadPassword:void 0},newBind:{siteName:void 0,nickName:void 0},dialog:{newBindDialog:!1,editDriveDialog:!1},editDriveSettings:{siteName:"",nickName:"",hiddenFolders:""},markdownText:""}},mounted:function(){var t=this;null==J.a.get("token")&&this.$router.push("login"),at(this.$store.state.settings.baseUrl+"/api/admin/info",null,(function(e){e.data.driveInfo.forEach((function(e){e.showTotal=W(e.quota.total),e.showUsed=W(e.quota.used),e.percent=e.quota.used/e.quota.total*100,t.drives.push(e)})),t.settings={officeName:e.data.officeName,officeType:e.data.officeType,appName:e.data.appName,webName:e.data.webName,defaultDrive:e.data.defaultDrive,accountStatus:e.data.accountStatus,footer:e.data.footer,allowAnonymouslyUpload:e.data.allowAnonymouslyUpload,uploadPassword:e.data.uploadPassword},t.markdownText=e.data.readme}))},methods:{updateSettings:function(){var t=this;et(this.$store.state.settings.baseUrl+"/api/admin/settings",this.settings,(function(){t.$store.commit("openSnackBar","更新成功！"),t.$router.go(0)}))},addSite:function(){var t=this;et(this.$store.state.settings.baseUrl+"/api/admin/sites",this.newBind,(function(){t.$store.commit("openSnackBar","绑定成功！"),t.dialog.newBindDialog=!1,t.$router.go(0)}))},unbind:function(t){var e=this;nt(this.$store.state.settings.baseUrl+"/api/admin/sites",{nickName:t},(function(){e.$store.commit("openSnackBar","已解除绑定"),e.dialog.newBindDialog=!1,e.$router.go(0)}))},openEditDriveDialog:function(t){this.editDriveSettings.nickName=t.nickName,this.editDriveSettings.hiddenFolders=t.hiddenFolders?t.hiddenFolders.join():"",this.editDriveSettings.siteName=t.name,this.dialog.editDriveDialog=!0},editDriveName:function(){var t=this;et(this.$store.state.settings.baseUrl+"/api/admin/sites/settings",this.editDriveSettings,(function(){t.$store.commit("openSnackBar","已更新驱动器设置"),t.dialog.newBindDialog=!1,t.$router.go(0)}))},updateReadme:function(){var t=this;et(this.$store.state.settings.baseUrl+"/api/admin/readme",{text:this.markdownText},(function(){t.$store.commit("openSnackBar","已更新 readme"),t.dialog.newBindDialog=!1,t.$router.go(0)}))}}},Ft=At,zt=a("99d9"),Mt=a("169a"),Rt=a("4bd4"),qt=a("490a"),Ht=a("b73d"),Yt=a("8654"),Gt=a("71d9"),Jt=Object(f["a"])(Ft,jt,Et,!1,null,null,null),Kt=Jt.exports;h()(Jt,{VBtn:z["a"],VCard:yt["a"],VCardActions:zt["a"],VCardSubtitle:zt["b"],VCardText:zt["c"],VCardTitle:zt["d"],VCol:st["a"],VContainer:Ct["a"],VDialog:Mt["a"],VDivider:C["a"],VForm:Rt["a"],VProgressCircular:qt["a"],VRow:Pt["a"],VSpacer:w["a"],VSwitch:Ht["a"],VTextField:Yt["a"],VToolbar:Gt["a"],VToolbarTitle:x["a"]});var Xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[a("v-toolbar-title",[t._v("进入后台")]),a("v-spacer")],1),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{label:"用户名",name:"login","prepend-icon":"mdi-account",type:"text"},model:{value:t.UserName,callback:function(e){t.UserName=e},expression:"UserName"}}),a("v-text-field",{attrs:{id:"password",label:"密码",name:"password","prepend-icon":"mdi-lock",type:"password"},model:{value:t.UserPassword,callback:function(e){t.UserPassword=e},expression:"UserPassword"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.Login}},[t._v("登录")])],1)],1)],1)],1)],1)},Zt=[],Qt={data:function(){return{UserName:null,UserPassword:null}},methods:{Login:function(){var t=this;et(this.$store.state.settings.baseUrl+"/api/user/authenticate",{username:this.UserName,password:this.UserPassword},(function(e){e.data.error?t.$store.commit("openSnackBar",e.data.message):(J.a.set("token",e.data.token,{expires:7}),t.$store.commit("openSnackBar","登录成功"),t.$router.push("admin"))}))}}},Wt=Qt,te=Object(f["a"])(Wt,Xt,Zt,!1,null,null,null),ee=te.exports;h()(te,{VBtn:z["a"],VCard:yt["a"],VCardActions:zt["a"],VCardText:zt["c"],VCol:st["a"],VContainer:Ct["a"],VForm:Rt["a"],VRow:Pt["a"],VSpacer:w["a"],VTextField:Yt["a"],VToolbar:Gt["a"],VToolbarTitle:x["a"]});var ae=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"12",md:"10","offset-md":"1",align:"start",justify:"center"}},[a("v-card",[a("v-card-title",[a("v-icon",[t._v(t._s(this.$store.state.show.icon))]),t._v(t._s(this.$store.state.show.name)+" ")],1),a("v-divider"),a("v-card-text",[a("div",{attrs:{id:"dplayer"}}),"mdi-image"==this.$store.state.show.icon?a("v-img",{attrs:{src:this.$store.state.show.downloadUrl},scopedSlots:t._u([{key:"placeholder",fn:function(){return[a("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[a("v-progress-circular",{attrs:{size:"75",indeterminate:""}})],1)]},proxy:!0}],null,!1,1359753949)}):t._e(),a("div",{attrs:{id:"markdown"}}),a("v-text-field",{staticClass:"mt-4",attrs:{"hide-details":"",readonly:"",label:"下载链接",value:this.$store.state.show.downloadUrl}}),"mdi-image"==this.$store.state.show.icon?a("v-text-field",{staticClass:"mt-4",attrs:{"hide-details":"",readonly:"",label:"Markdown",value:"![image]("+this.$store.state.show.downloadUrl+")"}}):t._e()],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{href:this.$store.state.show.url,text:""}},[t._v("下载")])],1)],1)],1)],1),a("v-btn",{staticClass:"float-btn",attrs:{fab:"",dark:"",color:"cyan"},on:{click:t.goBack}},[a("v-icon",[t._v("mdi-undo-variant")])],1)],1)},ne=[],oe=(a("eccb"),a("f7a5")),ie=a.n(oe),re={data:function(){return{fab:!1}},mounted:function(){"mdi-text-box-outline"==this.$store.state.show.icon&&i.a.get(this.$store.state.show.url).then((function(t){document.getElementById("markdown").innerHTML=ot(t.data)})),"mdi-movie"==this.$store.state.show.icon&&new ie.a({container:document.getElementById("dplayer"),screenshot:!0,autoplay:!0,video:{url:this.$store.state.show.url}})},methods:{goBack:function(){this.$router.go(-1)}}},se=re,le=(a("2926"),a("adda")),ce=Object(f["a"])(se,ae,ne,!1,null,null,null),de=ce.exports;h()(ce,{VBtn:z["a"],VCard:yt["a"],VCardActions:zt["a"],VCardText:zt["c"],VCardTitle:zt["d"],VCol:st["a"],VContainer:Ct["a"],VDivider:C["a"],VIcon:N["a"],VImg:le["a"],VProgressCircular:qt["a"],VRow:Pt["a"],VTextField:Yt["a"]});var ue=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"12",md:"8","offset-md":"2",align:"start",justify:"center"}},[a("v-card",[a("v-card-title",{attrs:{"primary-title":""}},[t._v(" 上传文件 ")]),a("v-card-text",[a("v-select",{attrs:{items:t.drives,label:"选择驱动器"},model:{value:t.selectedDrive,callback:function(e){t.selectedDrive=e},expression:"selectedDrive"}}),a("file-pond",{attrs:{server:t.server,"allow-revert":"false",instantUpload:"true","label-idle":"拖拽文件到这里 或者 浏览文件","allow-multiple":"true"}}),t._l(t.downloadUrls,(function(t,e){return a("v-text-field",{key:e,staticClass:"mt-4",attrs:{"hide-details":"",readonly:"",label:"下载链接",value:t}})}))],2)],1)],1)],1)],1)},ve=[],me=a("1501"),fe=a.n(me),pe=(a("4ed3"),a("1942")),he=a.n(pe),ge=fe()(he.a),be={data:function(){var t=this;return{uploadFiles:void 0,drives:[],downloadUrls:[],selectedDrive:void 0,server:{process:function(e,a,n,o,i,r,s,l,c){void 0!=t.selectedDrive?at("".concat(t.$store.state.settings.baseUrl,"/api/upload/").concat(t.selectedDrive,"/").concat(a.name),null,(function(e){var n=e.data.requestUrl;t.downloadUrls.push(e.data.fileUrl);var l=new XMLHttpRequest;return l.open("PUT",n),l.setRequestHeader("Content-Range","bytes 0-".concat(a.size-1,"/").concat(a.size)),l.upload.onprogress=function(t){r(t.lengthComputable,t.loaded,t.total)},l.onload=function(){l.status>=200&&l.status<300?o(l.responseText):i("上传错误")},l.send(a),{abort:function(){l.abort(),s()}}})):s()}},allowUpload:!1}},mounted:function(){var t=this;i.a.get(this.$store.state.settings.baseUrl+"/api/sites").then((function(e){e.data.forEach((function(e){t.drives.push({text:e.nickName,value:e.name})}))}))},methods:{},components:{FilePond:ge}},we=be,xe=a("b974"),ke=Object(f["a"])(we,ue,ve,!1,null,null,null),_e=ke.exports;h()(ke,{VCard:yt["a"],VCardText:zt["c"],VCardTitle:zt["d"],VCol:st["a"],VRow:Pt["a"],VSelect:xe["a"],VTextField:Yt["a"]}),n["default"].use(gt["a"]);var $e=[{path:"/show",name:"show",component:de},{path:"/upload",name:"upload",component:_e},{path:"/admin",name:"admin",component:Kt},{path:"/login",name:"login",component:ee},{path:"/:siteName?/:folderPath*",name:"Index",component:It}],De=new gt["a"]({routes:$e}),Ve=De,ye=a("f309");n["default"].use(ye["a"]);var Ce=new ye["a"]({});n["default"].config.productionTip=!1,new n["default"]({store:X,router:Ve,vuetify:Ce,render:function(t){return t(ht)}}).$mount("#app")},"7c52":function(t,e,a){},d5a2:function(t,e,a){},e8d0:function(t,e,a){"use strict";var n=a("3323"),o=a.n(n);o.a}});
//# sourceMappingURL=app.8b25141a.js.map